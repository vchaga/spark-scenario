import org.apache.spark.sql.functions._

val f1 = df.withColumn("clt_cpty_sgmt",
  when(col("clt_cc_id").isin(clientIddefaultslistcb: _*), "Central Bank")
    .when(col("clt_cc_id").isin(clientIddefaultslistfmu: _*), "Financial Market Utility")
    .when(col("clt_cc_id").isin(clientIddefaultslistsov: _*), "Sovereign")
    .when(col("clt_cc_id").isin(clientIddefaultslistgsed: _*), "Government Sponsored Entity")
    .when((col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistclbank: _*) && 
          (!(col("clt_le_id").isin("-1", "-2", "-3")) || col("clt_le_id").isNotNull)) ||
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistclbank: _*) && 
          (!(col("clt_le_id").isin("-1", "-2", "-3")) || col("clt_le_id").isNotNull)) && 
          col("clt_primary_ind_naics_credit").isNull), "Bank")
    .when((col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistnfc: _*) && 
          (col("clt_le_id").isin("-1", "-2", "-3") || col("clt_le_id").isNull)) ||
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistnfc: _*) && 
          (col("clt_le_id").isin("-1", "-2", "-3") || col("clt_le_id").isNull)) && 
          col("clt_primary_ind_naics_credit").isNull), "Non-Financial Corporate")
    .when(col("clt_cr_class") === "MULTI", "Multilateral Development Bank")
    .when(col("clt_cr_class") === "CCBNK", "Central Bank")
    .when((col("clt_cr_class").isin("USGSE") && col("clt_primary_ind_naics_credit").isin("522251")) ||
          (col("clt_cr_class").isin("USGSE") && col("clt_primary_ind_naics").isin("522251") && col("clt_primary_ind_naics_credit").isNull) ||
          (col("clt_cr_class").isin(crclassdefaultslist2gse: _*) && 
          col("clt_primary_ind_naics_credit").isin("522251") && 
          col("clt_primary_ind_naics").isin("522298", "522299")), "Government Sponsored Entity")
    .when((col("clt_cr_class").isin(crclassdefaultslistpse: _*) && 
          (!col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistgsepsepsnb: _*))) ||
          (col("clt_cr_class").isin(crclassdefaultslistpse: _*) && 
          (!col("clt_primary_ind_naics").isin(naicsIddefaultslistgsepsepsnb: _*)) && 
          col("clt_primary_ind_naics_credit").isNull) ||
          (col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistpse: _*) && 
          (!col("clt_cr_class").isin("GOBNK"))) ||
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistpse: _*) && 
          col("clt_primary_ind_naics_credit").isNull && 
          (!col("clt_cr_class").isin("GOBNK"))) ||
          (col("clt_cr_class").isin("GOBNK") && 
          col("clt_primary_ind_naics_credit").isin("921130", "921190", "923110", "926120", "929110")) ||
          (col("clt_cr_class").isin("GOBNK") && 
          col("clt_primary_ind_naics_credit").isNull && 
          col("clt_primary_ind_naics").isin("921130", "921190", "923110", "926120", "929110")), "Public Sector Entity")
    .when(col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistpf: _*) || 
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistpf: _*) && col("clt_primary_ind_naics_credit").isNull), "Pension Fund")
    .when(col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistbd: _*) || 
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistbd: _*) && col("clt_primary_ind_naics_credit").isNull), "Broker Dealer")
    .when(col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistic: _*) || 
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistic: _*) && col("clt_primary_ind_naics_credit").isNull), "Investment Company or Advisor")
    .when(col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistnr: _*) || 
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistnr: _*) && col("clt_primary_ind_naics_credit").isNull), "Non-Regulated Fund")
    .when(col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistb: _*) || 
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistb: _*) && col("clt_primary_ind_naics_credit").isNull) ||
          (col("clt_cr_class").isin("GOBNK") && col("clt_primary_ind_naics_credit").isin("522250", "522251")) ||
          (col("clt_cr_class").isin("GOBNK") && col("clt_primary_ind_naics").isin("522250", "522251") && col("clt_primary_ind_naics_credit").isNull), "Bank")
    .when(col("clt_primary_ind_naics_credit").isin(naicsIddefaultslistosnf: _*) || 
          (col("clt_primary_ind_naics").isin(naicsIddefaultslistosnf: _*) && col("clt_primary_ind_naics_credit").isNull), "Other Supervised Non-Bank Financial Entity")
    .when((col("clt_cr_class").isin("SP3PC", "SP3PF", "SPEPE", "SPJPC", "SPJPF")) || 
          (col("clt_primary_ind_naics_credit").isin("525995")) || 
          (col("clt_primary_ind_naics").isin("525995")), "Debt Issuing Special Purpose Entity")
    .otherwise("Other")
)
